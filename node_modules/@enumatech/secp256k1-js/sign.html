<!DOCTYPE html>
<html>

<head>
    <title>Eth Signer</title>
    <script src="BN.js" type="text/javascript"></script>
    <script src="sha3.min.js" type="text/javascript"></script>
    <script src="secp256k1.js" type="text/javascript"></script>
    <script src="wallet.js" type="text/javascript"></script>
</head>

<body>
    <input type="number" id="pin" value="111111">
    <input type="text" id="wordlist" value="a b c d e f g h i j k l">
    <button id="sign">Sign</button>
    <script type="text/javascript">
        function sign(e) {
            var pin = document.getElementById("pin").nodeValue;
            var wordlist = document.getElementById("wordlist").nodeValue;

            return deriveKeyFromWordList(wordlist, pin)
                .then(privateKey => {
                    return revokeByRecoveryKey(privateKey)
                    /*
                    const prefix = new Uint8Array([0x30, 0x41, 0x02, 0x01, 0x00, 0x30, 0x13, 0x06, 0x07, 0x2a, 0x86, 0x48, 0xce, 0x3d, 0x02, 0x01, 0x06, 0x08, 0x2a, 0x86, 0x48, 0xce, 0x3d, 0x03, 0x01, 0x07, 0x04, 0x27, 0x30, 0x25, 0x02, 0x01, 0x01, 0x04, 0x20]);
                    const pkcs8 = new Uint8Array(prefix.byteLength + privateKey.byteLength);
                    pkcs8.set(prefix, 0);
                    pkcs8.set(new Uint8Array(privateKey), prefix.byteLength);

                    return window.crypto.subtle.importKey(
                        "pkcs8", //can be "jwk" (public or private), "spki" (public only), or "pkcs8" (private only)
                        pkcs8,
                        {   //these are the algorithm options
                            name: "ECDSA",
                            namedCurve: "P-256", //can be "P-256", "P-384", or "P-521"
                        },
                        false, //whether the key is extractable (i.e. can be used in exportKey)
                        ["sign"] //"verify" for public key import, "sign" for private key imports
                    )
                    .then(privateKey => {
                        return window.crypto.subtle.sign(
                            {
                                name: "ECDSA",
                                hash: {name: "SHA-256"}, //can be "SHA-1", "SHA-256", "SHA-384", or "SHA-512"
                            },
                            privateKey, //from generateKey or importKey above
                            data //ArrayBuffer of data you want to sign
                        );
                    })*/
                }).then(signature => {
                    //returns an ArrayBuffer containing the signature
                    console.log(new Uint8Array(signature));
                }).catch(err => {
                    console.error(err.stack)
                })
        }

        document.getElementById("sign").addEventListener("click", sign);
    </script>
</body>

</html>